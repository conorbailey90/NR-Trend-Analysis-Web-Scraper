var TAObj = { "Date of Completion" : "", "Alert Number" : "", "Originator" : "", "OC Country" : "", "Originating Bank" : "", "OB Country" : "", "Locations Differ" : "No", "Intermediary 1" : "", "Int1 Country" : "", "Intermediary 2" : "", "Int 2 Country" : "", "Beneficiary Bank" : "", "BB Country" : "", "Beneficiary" : "", "BC Country" : "", "Locations Differ 2" : "", "Santander Customer Involvement" : "", "Outcome" : "Close", "Date SAR Submitted" : "", "SAR Acknowledgement" : "", "Scenario" : ""}
var alertNumber = document.querySelector("#main-content").innerText.slice(38,53);
TAObj['Alert Number'] = alertNumber;
var scenario = document.querySelector("#AMLCB__SMAlertDetectionDetailsrow0 > td.cell_AMLCB__DetectionList_ScenarioName_RO").innerText;
TAObj['Scenario'] = scenario;
window.name = JSON.stringify(TAObj);


var trow = document.querySelector("body > table > tbody > tr:nth-child(2)")
trow.select()

copy(trow.innerText)
  var textarea = document.createElement('textarea')
  textarea.id = 'temp_element'
  // Optional step to make less noise on the page, if any!
  textarea.style.height = 0
  // Now append it to your page somewhere, I chose <body>
  document.body.appendChild(textarea)
  // Give our textarea a value of whatever inside the div of id=containerid
  textarea.value = document.getElementById(containerid).innerText
  // Now copy whatever inside the textarea to clipboard
  var selector = document.querySelector('#temp_element')
  selector.select()
  document.execCommand('copy')
  // Remove the textarea
  document







var TAObj =  JSON.parse(window.name);
dataList = []
var bicCodes = { "ADCBAEAAXXX" : ["ABU DHABI COMMERCIAL BANK", "UAE"], "ABBYGB2LXXX" : ["Santander UK PLC", "United Kingdom"]}
var originator = document.querySelector("#STR_EIM__TransactionSummaryOriginator__EIM__Originator_Details_Static_1 > table > tbody > tr:nth-child(1) > td > span.pairRight.fieldspan_EIM__Originator_Name_1").innerText;
TAObj['Originator'] = originator
var originatorCountry = document.querySelector("#STR_EIM__TransactionSummaryOriginator__EIM__Originator_Details_Static_1 > table > tbody > tr:nth-child(6) > td > span.pairRight.fieldspan_EIM__Originator_Country_1").innerText;
TAObj['OC Country'] = originatorCountry;
var originatingBank = document.querySelector("#STR_EIM__TransactionSummaryOriginator__EIM__Originator_AccountDetails_Static_1 > table > tbody > tr:nth-child(2) > td > span.pairRight.fieldspan_EIM__Originator_AccountBIC_1").innerText;
if (originatingBank in bicCodes){
	TAObj['Originating Bank'] = bicCodes[originatingBank][0];
	TAObj['OB Country'] = bicCodes[originatingBank][1];
}else{
	TAObj['Originating Bank'] = originatingBank;
};
var beneLink = document.querySelector("#STR_EIM__TransactionSummaryBeneficiarytab");
setTimeout(function(){
    beneLink.click();
},500);
setTimeout(function(){
var beneficiary = document.querySelector("#STR_EIM__TransactionSummaryBeneficiary__EIM__Beneficiary_Details_Static_1 > table > tbody > tr:nth-child(1) > td > span.pairRight.fieldspan_EIM__Beneficiary_Name_1").innerText;
TAObj['Beneficiary'] = beneficiary
var beneficiaryBank = document.querySelector("#STR_EIM__TransactionSummaryBeneficiary__EIM__Beneficiary_AccountDetails_Static_1 > table > tbody > tr:nth-child(2) > td > span.pairRight.fieldspan_EIM__Beneficiary_AccountBIC_1").innerText;
if (beneficiaryBank in bicCodes){
TAObj['Beneficiary Bank'] = bicCodes[beneficiaryBank][0];
TAObj['BB Country'] = bicCodes[beneficiaryBank][1];
}else{
	TAObj['Beneficiary Bank'] = beneficiaryBank;
};

var beneficiaryCountry = document.querySelector("#STR_EIM__TransactionSummaryBeneficiary__EIM__Beneficiary_Details_Static_1 > table > tbody > tr:nth-child(6) > td > span.pairRight.fieldspan_EIM__Beneficiary_Country_1").innerText;
TAObj['BC Country'] = beneficiaryCountry;
TAObj['Locations Differ'] = (TAObj['OC Country'] == TAObj['OB Country'] ? "No" : "Yes")
TAObj['Locations Differ 2'] = (TAObj['BC Country'] == TAObj['BB Country'] ? "No" : "Yes")
TAObj['Santander Customer Involvement'] = (TAObj['Originating Bank'] ==  "Santander UK PLC" ||  TAObj['Beneficiary Bank'] == "Santander UK PLC" ? "Yes" : "No")
dataList.push (TAObj);
},1000);
with ({ copy }) { setTimeout(() => copy(dataList), 2000) }

setTimeout(function(){
console.log('Completed')
},2000);
